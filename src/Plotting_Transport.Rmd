---
title: "R Plots for Lateral Transport in the Mediterranean"
output: html_notebook
---





Notebook for making pretty figures from the lateral transport study.

```{r}
library(tidyverse)
library(ggmap)
library(cmocean)
```


Load data output from the batch analysis code.
```{r}

nemo_results_traj <- read_csv("../data/temp/nemo_results_traj.csv")
nemo_mean_ann_results <- read_csv("../data/temp/nemo_mean_ann_results.csv")
nemo_nov_may_results <- read_csv("../data/temp/nemo_nov_may_results.csv")
uk37_results_datatable <-read_csv("../data/temp/uk37_results_datatable.csv")
tex86_results_datatable <- read_csv("../data/temp/tex86_results_datatable.csv")

seas_matchup <- read.csv("../data/raw/Sediment_Locations_seas.csv")
```

Let's start by plotting transport distance and temperature offsets, maybe in jitter plots?
```{r}
plot1 <- nemo_mean_ann_results %>%
  ggplot(aes(
    x = speed,
    y = mean_dist,
    color = offset_ann_sst
  )) +
  geom_jitter() +
  scale_color_gradient2() +
  theme_grey()

plot1
```


Proxy offsets vs lateral transport offsets
```{r}
uk37_results_datatable$speed = factor(uk37_results_datatable$speed,levels = c("Sp_500","Sp_250","Sp_100","Sp_50","Sp_25","Sp_12","Sp_6"))

plot2 <- uk37_results_datatable %>%
  ggplot(aes(
    x = offset_ann_sst,
    y = proxy_offset_site,
    color = speed
  )) + 
  geom_point() +
  scale_color_brewer(palette = "YlGn") +
  theme_minimal()

plot2
```

Let's check to make sure the binning into subbasins worked correctly.
```{r}
seas_nemo_results <- left_join(nemo_mean_ann_results, select(seas_matchup, c(Location_key, Subbasin)), by = c("run_loc" = "Location_key"))
```

```{r}
seas_check <- seas_nemo_results %>%
  ggplot(aes(
    x = site_lon,
    y = site_lat,
    color = Subbasin
  )) +
  geom_point() +
  annotation_map(map_data("world")) +
  coord_fixed()

seas_check

ggsave("../results/figures/subbasin_map.eps")
```


```{r}
depth_dist_seas <- seas_nemo_results %>%
  filter(speed == "Sp_6") %>%
  ggplot(aes(
    x = water_depth,
    y = mean_dist,
    color = Subbasin
  )) +
  geom_point()

depth_dist_seas

ggsave("../results/figures/depth_dist_subbasin.eps")
```

```{r}
depth_offset_seas <- seas_nemo_results %>%
  filter(speed == "Sp_6") %>%
  ggplot(aes(
    x = water_depth,
    y = offset_ann_sst,
    color = Subbasin
  )) +
  geom_point()

depth_offset_seas
```
























